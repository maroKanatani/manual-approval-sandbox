name: Do Something
on:
  workflow_dispatch:
  release:
    types:
      - published

concurrency:
  group: ${{ github.workflow }}
  cancel-in-progress: true

permissions:
  issues: write

jobs:
  deploy:
    runs-on: ubuntu-latest
    timeout-minutes: 10

    steps:
      - name: "Set Issue Title & Body"
        id: set_issue_title_body
        if: github.event_name == 'release' || github.event_name == 'workflow_dispatch'
        run: |
          if [ "${{ github.event_name }}" == "release" ]; then
            echo "::set-output name=ISSUE_TITLE::${{ github.event.release.name }}"
            echo "::set-output name=ISSUE_BODY::${{ github.event.release.body }}"
          else if [ "${{ github.event_name }}" == "workflow_dispatch" ]; then
            echo "::set-output name=ISSUE_TITLE::${{ github.event.release.name }}"
            echo "::set-output name=ISSUE_BODY::${{ github.event.release.body }}"
          fi
      - uses: trstringer/manual-approval@v1
        timeout-minutes: 10
        with:
          secret: ${{ secrets.GITHUB_TOKEN }}
          approvers: maroKanatani
          minimum-approvals: 1
          issue-title: ${{ steps.set_issue_title_body.outputs.ISSUE_TITLE }}
          issue-body: ${{ steps.set_issue_title_body.outputs.ISSUE_BODY }}
      - name: do something
        run: echo "Hello"
